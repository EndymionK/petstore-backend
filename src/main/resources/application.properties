# ==========================================
# CONFIGURACIÓN DE BASE DE DATOS
# ==========================================
# IMPORTANTE: Las credenciales sensibles se cargan desde variables de entorno
# para mayor seguridad. El archivo acepta tanto las variables antiguas (SPRING_DATASOURCE_*)
# como las nuevas (DB_URL / DB_USERNAME / DB_PASSWORD). Si no se definen, se usan valores por defecto.

# Usando Supabase Pooler en modo Transaction (puerto 6543) para evitar límite de conexiones
# Modo Transaction es más eficiente para aplicaciones con múltiples instancias
spring.datasource.url=${SPRING_DATASOURCE_URL:${DB_URL:jdbc:postgresql://aws-1-us-east-2.pooler.supabase.com:6543/postgres?prepareThreshold=0}}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:${DB_USERNAME:postgres.bvxlhjnopjvdjliyprpn}}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:${DB_PASSWORD:peim7wiOri5Xe4RQ}}
spring.datasource.driver-class-name=org.postgresql.Driver

# ==========================================
# CONFIGURACIÓN DE CONNECTION POOL (HikariCP)
# ==========================================
# Limitar el número de conexiones para evitar exceder límites de Supabase
spring.datasource.hikari.maximum-pool-size=${HIKARI_MAX_POOL_SIZE:5}
spring.datasource.hikari.minimum-idle=${HIKARI_MIN_IDLE:2}
spring.datasource.hikari.connection-timeout=${HIKARI_CONNECTION_TIMEOUT:30000}
spring.datasource.hikari.idle-timeout=${HIKARI_IDLE_TIMEOUT:600000}
spring.datasource.hikari.max-lifetime=${HIKARI_MAX_LIFETIME:1800000}

# ==========================================
# CONFIGURACIÓN DE JPA/HIBERNATE
# ==========================================
# Hibernate detecta automáticamente el dialecto PostgreSQL, no es necesario especificarlo
spring.jpa.show-sql=${JPA_SHOW_SQL:true}
spring.jpa.properties.hibernate.format_sql=true

# Por seguridad en producción se recomienda 'validate'. Cambia con la variable JPA_HIBERNATE_DDL_AUTO
spring.jpa.hibernate.ddl-auto=${JPA_HIBERNATE_DDL_AUTO:validate}
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl

# ==========================================
# CONFIGURACIÓN DE JWT
# ==========================================
# IMPORTANTE: En producción, usar una clave secreta fuerte en Base64 (sin caracteres especiales)
# Genera una con: openssl rand -base64 64
jwt.secret.key=${JWT_SECRET_KEY:OC+HmDZHURX5HYQRf2cL4dwzAK2Fd5edscPW1YkfsEvXrefUAnUIrfr5AMj4tMlSAxKj6VfUD4zRBA1ITGYAwg==}
jwt.expiration.time=${JWT_EXPIRATION_TIME:3600000}

# ==========================================
# CONFIGURACIÓN DE SESIONES
# ==========================================
# Tiempo de expiración por inactividad en milisegundos (15 minutos por defecto)
session.inactivity.timeout=${SESSION_INACTIVITY_TIMEOUT:900000}
